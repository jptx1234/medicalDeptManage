<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <meta charset="utf-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>物品包类别维护</title> 

<link href="css/base.css" rel="stylesheet">
<link rel="stylesheet" href="../custom/uimaker/easyui.css">
<link rel="stylesheet" type="text/css" href="../custom/uimaker/icon.css">
<link rel="stylesheet" href="css/providers.css">
<style>
	#ff label{
		width: 20%;
	}
	#ff input.textbox-text{
		height: 33px;
		width: 80%;
		line-height: 33px;
	}
	#ff .form-row{
		margin-bottom: 20px;
	}
</style>
</head> 
<body>
	<div id="tb" style="padding:0 30px;">
        类别名称: <input class="easyui-textbox" type="text" name="name" style="width:166px;height:35px;line-height:35px;"></input>
        <a href="javascript:;" id="qryBtn" class="easyui-linkbutton" iconCls="icon-search" data-options="selected:true">查询</a>
        <a href="javascript:;" id="resetBtn" class="easyui-linkbutton" iconCls="icon-reload">重置</a>
        <div style="float: right;">
        	<a href="javascript:;" id="addBtn" class="easyui-linkbutton" iconCls="icon-add">新增</a>
        	<a href="javascript:;" id="deleteBtn" class="easyui-linkbutton" iconCls="icon-remove">删除</a>
        </div>
      </div>
    <div class="container">
       <table id="dg" style="width:100%;height:554px" title="物品包类别维护">
            <thead>
                <tr>
                    <th field="id" data-options="halign: 'center', align:'center', checkbox: true" style="width: 5%;">选择</th>
                    <th field="packTypeName" data-options="halign: 'center', align:'center'" style="width: 30%;">类别名称</th>
                    <th field="packTypeDesc" data-options="halign: 'center', align:'center'" style="width: 50%;">类别描述</th>
                    <th field="createDate" data-options="halign: 'center', align:'center'" style="width: 15%;">创建时间</th>
                </tr>
            </thead>
        </table>
    </div>
    
    <script type="text/javascript" src="../custom/jquery.min.js"></script>
    <script type="text/javascript" src="../custom/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../custom/easyui-lang-zh_CN.js"></script>



	<div id="win" class="easyui-window" title="添加物品包类别" style="width:600px;height:500px;padding: 20px;"   
        data-options="iconCls:'icon-save',modal:true, closed: true">   
	    <form id="ff" method="post" style="width: 400px;margin: 0 auto;">   
		    <div class="form-row">   
		        <label for="packTypeName" >类别名称：</label>
		        <input name="packTypeName" type="text" class="textbox-text" maxlength="255" title="请输入物品包类别名称，最多255个字节" />
		    </div>   
		    <div class="form-row">   
		        <label for="packTypeDesc" >类别描述：</label>   
		        <input name="packTypeDesc" type="text" class="textbox-text" maxlength="2000" title="请输入物品包类别名称，最多2000个字节" />  
		    </div>
		    <div >
		    	<label for="packTypeImg">类别图片：</label>
		    	<input name="packTypeImg" type="file" />
		    	<div style="text-align: center;margin-top: 20px;" >
		    		<img id="img-preview" height="200" />
		    	</div>
		    </div>
		    <div style="margin-top: 18px;">
		    	<a href="javascript:;" id="submitBtn" class="easyui-linkbutton" iconCls="icon-ok" style="float: left;margin-left: 30px;" data-options="selected:true">提交</a>
        		<a href="javascript:;" id="resetAddBtn" class="easyui-linkbutton" iconCls="icon-reload"  style="float: right;margin-right: 30px;">重置</a>
		    </div>
		</form>  
	</div>  

    <script type="text/javascript">
    	baseUrl = '..';
    	$(function(){
    		$("#dg").datagrid({
    			pagination: true,
    			striped: true,
    			toolbar: '#tb',
				idField: 'id',
				url: baseUrl+'/stuffPackType/list',
				rownumbers:true,
                singleSelect:false,
                autoRowHeight:false,
                pagination:true,
                fitColumns:true,
                striped:true,
                checkOnSelect:true,
                selectOnCheck:true,
                collapsible:true,
                toolbar:'#tb',
                pageSize:10
    		});
    		
    		$("#qryBtn").click(function(){
    			$("#dg").datagrid('load', {
    				name: $('input[name=name]').val()
    			});
    		});
    		
    		$('#resetBtn').click(function(){
    			$('input[name=name]').val('');
    		});
    		
    		$('#deleteBtn').click(function(){
    			var checkedRows = $('#dg').datagrid('getChecked');
    			var ids = new Array();
    			for(i=0, len = checkedRows.length; i < len; i++){
    				ids.push(checkedRows[i].id);
    			}
    			if(ids.length < 1){
    				$.messager.alert('删除失败', '请在要删除的类别前面打钩', 'error');
    				return;
    			}
    			$.messager.confirm('删除确认', '是否删除这'+ids.length+'条', function(b){
    				if(b){
    					$.post(baseUrl+'/stuffPackType/delete', {id: ids.join(',')}, function(data){
    						if(data.status == 200){
    							$.messager.alert('删除成功', data.msg, 'info', function(){$('#dg').datagrid('reload');});
    						}else{
    							$.messager.alert('删除失败', data.msg, 'error', function(){$('#dg').datagrid('reload');});
    						}
    					});
    					
    				}
    			});
    		});
    		
    		$('#addBtn').click(function(){
    			$('#win').window('open');
    		});
    		
    		$('#ff').form({    
			    onSubmit: function(){    
			    },    
			    success:function(data){    
			        alert(data)    
			    }    
			});
			
			$('#ff input[name=packTypeImg]').change(function(){
				var previewImg = $('#img-preview');
				if(!this.files || this.files.length < 1){
					previewImg.removeAttr('src');
					return;
				}
				var reader = new FileReader();
				reader.onload = function(evt) {
					previewImg.attr('src', evt.target.result);
				}
				reader.readAsDataURL(this.files[0]);
			});
			
			$('#resetAddBtn').click(function(){
				$('#ff').form('clear');
			});
			
    	});
    </script>
</body> 
</html>
